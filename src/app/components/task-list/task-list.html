<!-- Main container for task list -->
<div class="task-card">

  <!-- Header section -->
  <div class="task-header">

    <!-- Title and icon -->
    <div class="task-title">
      <mat-icon class="task-icon">view_list</mat-icon>
      <div>
        <h3>Tasks</h3>
        <p>All Tasks</p>
        <span class="record-count">{{ filteredTasks.length }} records</span> <!-- Show number of tasks -->
      </div>
    </div>

    <!-- Action buttons and search -->
    <div class="task-actions">

      <!-- New Task & Refresh buttons -->
      <div class="button-row">
        <button class="btn btn-primary" (click)="showForm = true">New Task</button>
        <button class="btn btn-secondary" (click)="refresh()">Refresh</button>
      </div>

      <!-- Search bar -->
      <div class="search-row">
        <input
          type="text"
          placeholder="Search"
          [(ngModel)]="searchTerm"
          (input)="search()"
        />
        <mat-icon class="search-icon">search</mat-icon>
      </div>

    </div>
  </div>

  <!-- Task table -->
  <table class="task-table">
    <thead>
      <tr>
        <th><input type="checkbox" /></th>
        <th>Assigned To</th>
        <th>Status</th>
        <th>Due Date</th>
        <th>Priority</th>
        <th>Comments</th>
      </tr>
    </thead>

    <tbody>
      <!-- Loop through filtered tasks -->
      <tr *ngFor="let task of filteredTasks">
        <td><input type="checkbox" /></td>
        <td class="link">{{ task.assignedTo }}</td>
        <td>{{ task.status }}</td>
        <td>{{ task.dueDate | date: 'dd/MM/yyyy' }}</td>
        <td>{{ task.priority }}</td>
        <td class="comments-cell">
          {{ task.comments }}
          <!-- Dropdown for Edit/Delete actions -->
          <div class="dropdown">
            <button class="dropdown-btn">â‹®</button>
            <div class="dropdown-content">
              <a (click)="editTask(task)">Edit</a>
              <a (click)="deleteTask(task)">Delete</a>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Pagination controls -->
  <div class="pagination">
    <select>
      <option>20</option>
      <option>50</option>
      <option>100</option>
    </select>
    <div class="pager">
      <button>&lt; First</button>
      <button>&lt; Prev</button>
      <span>1</span>
      <button>Next &gt;</button>
      <button>Last &gt;</button>
    </div>
  </div>

  <!-- Task form popup -->
  <app-task-form
    *ngIf="showForm"
    [task]="editingTask"
    (save)="addTask($event)"
    (cancel)="closeForm()"
  ></app-task-form>

  <!-- Confirm delete popup -->
  <app-confirm-dialog
    [show]="showConfirm"
    title="Delete"
    [message]="'Do you want to delete task ' + (taskToDelete?.assignedTo || '') + '?'"
    (confirm)="confirmDelete()"
    (cancel)="cancelDelete()"
  ></app-confirm-dialog>

</div>
